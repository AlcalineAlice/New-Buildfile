#ifndef BATTLE_CALCULATIONS
#define BATTLE_CALCULATIONS

// battle calculations loop fe8

#define BC_DefRes $2aa44
#define BC_Power $2aabc
#define BC_ASpd $2ab74
#define BC_Hit $2abac
#define BC_Avo $2abe4
#define BC_Crit $2ac18
#define BC_Dodge $2ac54
#define BC_Support $2a9d0
#define BC_WRank $2ad54
#define BC_Status $2ad90

#include "Extensions/Hack Installation.txt"

PUSH
	ORG 0x2a95c
		jumpToHack(BtlLoopParent)

	ORG 0x2a3f8
		//rewrite range map
		jumpToHack(RewriteRangeMapHook)

	// ORG 0x2AFFE //make 0xc = cannot double
		// SHORT 0x280C 0xD005
POP

//under free space
ALIGN 4
BtlLoopParent:
	#incbin "Src/BattleCalcLoop.dmp"

	// Vanilla battle calculations
	POIN BC_DefRes BC_Power BC_ASpd BC_Hit BC_Avo BC_Crit BC_Dodge BC_Support BC_WRank BC_Status

	// TODO: guard all of those with ifdefs

	POIN BC_FaireSkills
	POIN BC_BreakerSkills
	POIN BC_BlowSkills
	POIN BC_DefenseSkills
	POIN BC_CritUpSkill
	POIN BC_WrathSkill
	POIN BC_LuckySevenSkill BC_OddRhythmSkill BC_EvenRhythmSkill BC_QuickBurnSkill BC_SlowBurnSkill
	POIN BC_ElbowRoomSkill BC_NaturalCoverSkill
	POIN BC_GambleSkill
	POIN BC_FieryBloodSkill
	POIN BC_LifeAndDeathSkill
	POIN BC_WindDiscipleSkill
	POIN BC_HawkeyeSkill
	POIN BC_LightWeightSkill
	POIN BC_PerfectionistSkill
	POIN BC_PuissanceSkill
	POIN BC_TrampleSkill
	POIN BC_OpportunistSkill
	POIN BC_AxefaithSkill
	POIN BC_StanceSkills
	POIN BC_SpurStrSkill BC_SpurMagSkill BC_SpurSpdSkill BC_SpurDefSkill BC_SpurResSkill
	POIN BC_DemoiselleSkill BC_GentilhommeSkill

	POIN HolyAura MageSlayer Loyalty Infiltrator BattleVeteran SilentPride Thunderstorm Outrider HeavyStrikes Charge Vanity KnightAspirant
	POIN MaleficAura Intimidate Tantivy Focus Inspiration Charm Solidarity VoiceOfPeace Anathema LilysPoise Charisma Hex UpWithArch

	// Because of how killing machine works, critical check should always be done after other crit-modifying skills
	POIN BC_CriticalModifierSkills

#ifdef __GBA_LETHALITY__
	POIN BC_LethalitySkill
#else
	POIN BC_LethalitySkill BC_NonGBALethalitySkill
#endif

	POIN BC_BaneSkill

	//add any new ones before here
	WORD 0

ALIGN 4
RewriteRangeMapHook:
	#incbin "Src/RewriteRangeMap.dmp"

#endif // BATTLE_CALCULATIONS
